
plugins {
id 'application'
  id 'java'
}

ext.libraries = [
    base: [
    "com.google.code.gson:gson:2.8.5",
        "com.google.auto.service:auto-service:1.1.1",
    "org.apache.logging.log4j:log4j-core:2.17.0",
    "org.jsoup:jsoup:1.13.1",
    "org.codehaus.groovy:groovy:2.5.23"
    ],
        apacheBase: [
    "org.apache.commons:commons-vfs2:2.9.0",
    ],
    graalvm: [
    "org.graalvm.js:js:23.0.0"
    ],
    junit: [
      "org.junit.jupiter:junit-jupiter-api:5.10.2",
"org.junit.jupiter:junit-jupiter-engine:5.10.2"
]]

allprojects {
repositories {
mavenCentral()
}
}

dependencies {
}

task downloadAndExtractData {
    def destDir = layout.buildDirectory.dir("luwrain-install/data").get().asFile

    doLast {
        if (!destDir.exists()) {
            destDir.mkdirs()
        }

        ['rhvoice-data.tar.xz', 'hunspell.tar.xz'].each { name ->
            def url = "https://download.luwrain.org/compilation/${name}"
            def file = new File(destDir, name)

            println "Downloading $url..."
            new URL(url).withInputStream { i ->
                file.withOutputStream { it << i }
            }

            println "Extracting ${name}..."
            exec {
                workingDir destDir
                commandLine 'tar', 'xf', name
            }

            file.delete()
        }

        def schemesDir = new File(destDir, "sounds/schemes")
        if (schemesDir.exists()) {
            schemesDir.deleteDir()
        }
    }
}
